# $Id$


#export SCALA_HOME=/Users/tarq/Downloads/scala-trunk/build/quick/
#export PATH=$SCALA_HOME/bin:$PATH

#clear

echo === compiling plugin

mkdir -p target/classes
mkdir -p target/test-classes

scalac -deprecation -d target/classes -cp $SCALA_HOME/classes/compiler/ src/*.scala

jar cf target/selectivecps.jar -C misc/ scalac-plugin.xml -C target/classes .


echo === compiling test code using plugin

scalac	-Xplugin:target/selectivecps.jar \
	-Xprint:selectiveanf \
	-Xprint:selectivecps \
	-d target/test-classes \
	test-src/*.scala


echo === running compiled test code

scala -cp $SCALA_HOME/classes/compiler/:target/test-classes/ "$@"
